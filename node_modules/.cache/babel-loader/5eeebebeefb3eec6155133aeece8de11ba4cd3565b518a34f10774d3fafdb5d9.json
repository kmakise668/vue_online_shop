{"ast":null,"code":"import { createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, toDisplayString as _toDisplayString, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"flex min-h-full flex-1 flex-col justify-center px-6 py-12 lg:px-8\"\n};\nconst _hoisted_2 = /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"sm:mx-auto sm:w-full sm:max-w-sm\"\n}, [/*#__PURE__*/_createElementVNode(\"h2\", {\n  class: \"mt-10 text-center text-2xl font-bold leading-9 tracking-tight text-gray-900\"\n}, \"Войдите в свой аккаунт\")], -1);\nconst _hoisted_3 = {\n  class: \"mt-10 sm:mx-auto sm:w-full sm:max-w-sm\"\n};\nconst _hoisted_4 = /*#__PURE__*/_createElementVNode(\"label\", {\n  for: \"email\",\n  class: \"block text-sm font-medium leading-6 text-gray-900\"\n}, \"Email адрес\", -1);\nconst _hoisted_5 = {\n  class: \"mt-2\"\n};\nconst _hoisted_6 = /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"flex items-center justify-between\"\n}, [/*#__PURE__*/_createElementVNode(\"label\", {\n  for: \"password\",\n  class: \"block text-sm font-medium leading-6 text-gray-900\"\n}, \"Пароль\"), /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"text-sm\"\n}, [/*#__PURE__*/_createElementVNode(\"a\", {\n  href: \"#\",\n  class: \"font-semibold text-indigo-600 hover:text-indigo-500\"\n}, \"Забыли пароль?\")])], -1);\nconst _hoisted_7 = {\n  class: \"mt-2\"\n};\nconst _hoisted_8 = /*#__PURE__*/_createElementVNode(\"div\", null, [/*#__PURE__*/_createElementVNode(\"button\", {\n  type: \"submit\",\n  class: \"flex w-full justify-center rounded-md bg-indigo-600 px-3 py-1.5 text-sm font-semibold leading-6 text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600\"\n}, \"Войти\")], -1);\nconst _hoisted_9 = {\n  class: \"mt-10 text-center font-semibold text-sm leading-6 text-red-400\"\n};\nconst _hoisted_10 = /*#__PURE__*/_createElementVNode(\"p\", {\n  class: \"mt-4 text-center font-medium text-sm leading-6 text-gray-400 hover:text-indigo-500\"\n}, \"Еще не регистрировались?\", -1);\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_router_link = _resolveComponent(\"router-link\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_hoisted_2, _createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"form\", {\n    class: \"space-y-6\",\n    action: \"#\",\n    onSubmit: _cache[2] || (_cache[2] = (...args) => $options.login && $options.login(...args))\n  }, [_createElementVNode(\"div\", null, [_hoisted_4, _createElementVNode(\"div\", _hoisted_5, [_withDirectives(_createElementVNode(\"input\", {\n    id: \"email\",\n    name: \"email\",\n    type: \"email\",\n    autocomplete: \"email\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.email = $event),\n    required: \"\",\n    class: \"block w-full rounded-md border-0 py-1.5 px-2 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6\"\n  }, null, 512), [[_vModelText, $data.email]])])]), _createElementVNode(\"div\", null, [_hoisted_6, _createElementVNode(\"div\", _hoisted_7, [_withDirectives(_createElementVNode(\"input\", {\n    id: \"password\",\n    name: \"password\",\n    type: \"password\",\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $data.password = $event),\n    autocomplete: \"current-password\",\n    required: \"\",\n    class: \"block w-full rounded-md border-0 py-1.5 px-2 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6\"\n  }, null, 512), [[_vModelText, $data.password]])])]), _hoisted_8], 32), _createElementVNode(\"p\", _hoisted_9, _toDisplayString($data.errorMessage), 1), _createVNode(_component_router_link, {\n    to: \"/register\"\n  }, {\n    default: _withCtx(() => [_hoisted_10]),\n    _: 1\n  })])]);\n}","map":{"version":3,"names":["class","_createElementVNode","for","href","type","_createElementBlock","_hoisted_1","_hoisted_2","_hoisted_3","action","onSubmit","_cache","args","$options","login","_hoisted_4","_hoisted_5","id","name","autocomplete","$data","email","$event","required","_hoisted_6","_hoisted_7","password","_hoisted_8","_hoisted_9","_toDisplayString","errorMessage","_createVNode","_component_router_link","to","_hoisted_10"],"sources":["/Users/dev/Desktop/vue /src/components/login/v-login.vue"],"sourcesContent":["\n<template>\n  <div class=\"flex min-h-full flex-1 flex-col justify-center px-6 py-12 lg:px-8\">\n    <div class=\"sm:mx-auto sm:w-full sm:max-w-sm\">\n\n      <h2 class=\"mt-10 text-center text-2xl font-bold leading-9 tracking-tight text-gray-900\">Войдите в свой аккаунт</h2>\n    </div>\n\n    <div class=\"mt-10 sm:mx-auto sm:w-full sm:max-w-sm\">\n      <form class=\"space-y-6\" action=\"#\" @submit=\"login\">\n        <div>\n          <label for=\"email\" class=\"block text-sm font-medium leading-6 text-gray-900\">Email адрес</label>\n          <div class=\"mt-2\">\n            <input id=\"email\" name=\"email\" type=\"email\" autocomplete=\"email\" v-model=\"email\" required=\"\" class=\"block w-full rounded-md border-0 py-1.5  px-2 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6\" />\n          </div>\n        </div>\n\n        <div>\n          <div class=\"flex items-center justify-between\">\n            <label for=\"password\" class=\"block text-sm font-medium leading-6 text-gray-900\">Пароль</label>\n            <div class=\"text-sm\">\n              <a href=\"#\" class=\"font-semibold text-indigo-600 hover:text-indigo-500\">Забыли пароль?</a>\n            </div>\n          </div>\n          <div class=\"mt-2\">\n            <input id=\"password\" name=\"password\" type=\"password\" v-model=\"password\" autocomplete=\"current-password\" required=\"\" class=\"block w-full rounded-md border-0 py-1.5 px-2 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6\" />\n          </div>\n        </div>\n\n        <div>\n          <button type=\"submit\" class=\"flex w-full justify-center rounded-md bg-indigo-600 px-3 py-1.5 text-sm font-semibold leading-6 text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600\">Войти</button>\n        </div>\n      </form>\n      <p class=\"mt-10 text-center font-semibold text-sm leading-6 text-red-400\">{{ errorMessage }}</p>\n      <router-link to=\"/register\">\n      <p class=\"mt-4 text-center font-medium text-sm leading-6 text-gray-400 hover:text-indigo-500\">Еще не регистрировались?</p>\n </router-link>\n    </div>\n  </div>\n</template>\n\n  <script>\n  import axios from 'axios';\n  import jwt_decode from 'jwt-decode';\n  \n  export default {\n    data() {\n      return {\n        email: '',\n        password: '',\n        res: '',\n        errorMessage: ''\n      };\n    },\n    methods: {\n  async login(event) {\n    event.preventDefault();\n    try {\n      const response = await axios.post('http://localhost:7676/api/users/login', {\n        email: this.email,\n        password: this.password,\n      });\n\n      if (response.status === 200) {\n        const accessToken = response.data.accessToken;\n\n        // Устанавливаем куки с токеном\n        document.cookie = `accessToken=${accessToken}; Secure; SameSite=Strict;`;\n\n        const { role, id } = jwt_decode(accessToken);\n        localStorage.setItem('role', role);\n        localStorage.setItem('id', id);\n        // alert(accessToken)\n        this.$store.commit('SET_AUTH', true);\n        this.$store.commit('SET_ROLE', role);\n        // Выполняем действия на основе роли пользователя\n        if (role === 1) {\n         this.$router.push('/admin');\n        } else {\n          this.$router.push('/dashboard');\n        }\n      }\n    } catch (error) {\n    console.error(error);\n    if (error.response && error.response.status === 401) {\n  this.errorMessage = 'Ошибка: ' + error.response.data.message\n} else if (error.response && error.response.status === 500) {\n  this.errorMessage = 'Внутренняя ошибка сервера';\n} else {\n  this.errorMessage = 'Не удалось выполнить запрос';\n}\n\n}\n\n\n\n\n\n\n  },\n},\n\n  };\n  </script>\n  \n\n  <style>.success-message {\n    color: green;\n    font-weight: bold;\n  }\n  \n  /* Ваши стили для сообщений об ошибке */\n  .error-message {\n    color: red;\n    font-weight: bold;\n  }</style>"],"mappings":";;EAEOA,KAAK,EAAC;AAAmE;gCAC5EC,mBAAA,CAGM;EAHDD,KAAK,EAAC;AAAkC,I,aAE3CC,mBAAA,CAAmH;EAA/GD,KAAK,EAAC;AAA6E,GAAC,wBAAsB,E;;EAG3GA,KAAK,EAAC;AAAwC;gCAG7CC,mBAAA,CAAgG;EAAzFC,GAAG,EAAC,OAAO;EAACF,KAAK,EAAC;GAAoD,aAAW;;EACnFA,KAAK,EAAC;AAAM;gCAMjBC,mBAAA,CAKM;EALDD,KAAK,EAAC;AAAmC,I,aAC5CC,mBAAA,CAA8F;EAAvFC,GAAG,EAAC,UAAU;EAACF,KAAK,EAAC;GAAoD,QAAM,G,aACtFC,mBAAA,CAEM;EAFDD,KAAK,EAAC;AAAS,I,aAClBC,mBAAA,CAA0F;EAAvFE,IAAI,EAAC,GAAG;EAACH,KAAK,EAAC;GAAsD,gBAAc,E;;EAGrFA,KAAK,EAAC;AAAM;gCAKnBC,mBAAA,CAEM,c,aADJA,mBAAA,CAAmS;EAA3RG,IAAI,EAAC,QAAQ;EAACJ,KAAK,EAAC;GAAyP,OAAK,E;;EAG3RA,KAAK,EAAC;AAAgE;iCAEzEC,mBAAA,CAA0H;EAAvHD,KAAK,EAAC;AAAoF,GAAC,0BAAwB;;;uBAjC1HK,mBAAA,CAoCM,OApCNC,UAoCM,GAnCJC,UAGM,EAENN,mBAAA,CA6BM,OA7BNO,UA6BM,GA5BJP,mBAAA,CAuBO;IAvBDD,KAAK,EAAC,WAAW;IAACS,MAAM,EAAC,GAAG;IAAEC,QAAM,EAAAC,MAAA,QAAAA,MAAA,UAAAC,IAAA,KAAEC,QAAA,CAAAC,KAAA,IAAAD,QAAA,CAAAC,KAAA,IAAAF,IAAA,CAAK;MAC/CX,mBAAA,CAKM,cAJJc,UAAgG,EAChGd,mBAAA,CAEM,OAFNe,UAEM,G,gBADJf,mBAAA,CAAmT;IAA5SgB,EAAE,EAAC,OAAO;IAACC,IAAI,EAAC,OAAO;IAACd,IAAI,EAAC,OAAO;IAACe,YAAY,EAAC,OAAO;+DAAUC,KAAA,CAAAC,KAAK,GAAAC,MAAA;IAAEC,QAAQ,EAAC,EAAE;IAACvB,KAAK,EAAC;gCAAzBoB,KAAA,CAAAC,KAAK,E,OAInFpB,mBAAA,CAUM,cATJuB,UAKM,EACNvB,mBAAA,CAEM,OAFNwB,UAEM,G,gBADJxB,mBAAA,CAAyU;IAAlUgB,EAAE,EAAC,UAAU;IAACC,IAAI,EAAC,UAAU;IAACd,IAAI,EAAC,UAAU;+DAAUgB,KAAA,CAAAM,QAAQ,GAAAJ,MAAA;IAAEH,YAAY,EAAC,kBAAkB;IAACI,QAAQ,EAAC,EAAE;IAACvB,KAAK,EAAC;gCAA5DoB,KAAA,CAAAM,QAAQ,E,OAI1EC,UAEM,C,OAER1B,mBAAA,CAAgG,KAAhG2B,UAAgG,EAAAC,gBAAA,CAAnBT,KAAA,CAAAU,YAAY,OACzFC,YAAA,CAESC,sBAAA;IAFIC,EAAE,EAAC;EAAW;sBAC3B,MAA0H,CAA1HC,WAA0H,C"},"metadata":{},"sourceType":"module","externalDependencies":[]}